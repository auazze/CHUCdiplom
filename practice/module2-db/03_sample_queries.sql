-- ============================================================
-- Модуль 3: Примеры SQL-запросов (тренировка)
-- ============================================================

USE DemExam;
GO

-- 1. Все контрагенты
SELECT * FROM Контрагенты;

-- 2. Только покупатели
SELECT Наименование, ИНН, Телефон
FROM Контрагенты
WHERE Покупатель = 1;

-- 3. Только поставщики
SELECT Наименование, Адрес
FROM Контрагенты
WHERE Поставщик = 1;

-- 4. Поставщики И покупатели одновременно
SELECT Наименование
FROM Контрагенты
WHERE Поставщик = 1 AND Покупатель = 1;

-- 5. Количество контрагентов по категориям
SELECT
    SUM(CASE WHEN Поставщик = 1 THEN 1 ELSE 0 END) AS ВсегоПоставщиков,
    SUM(CASE WHEN Покупатель = 1 THEN 1 ELSE 0 END) AS ВсегоПокупателей
FROM Контрагенты;

-- 6. Поиск по части названия
SELECT * FROM Контрагенты
WHERE Наименование LIKE N'%ООО%';

-- 7. Сортировка по имени
SELECT Наименование, ИНН
FROM Контрагенты
ORDER BY Наименование ASC;

-- 8. Пример JOIN: заказы с названиями контрагентов
-- (когда данные добавлены)
-- SELECT з.Номер, з.Дата, к.Наименование, з.Сумма
-- FROM ЗаказыПокупателей з
-- JOIN Контрагенты к ON з.КонтрагентId = к.Id
-- ORDER BY з.Дата DESC;

GO
